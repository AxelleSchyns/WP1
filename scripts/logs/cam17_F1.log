-----------------------------------------------------------------------------------------------
------------------------------------- Model 1 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/resnet/model2/last_epoch
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 3.8031511306762695
Time of the transfer: 142.29191064834595
Time of the indexing: 7.832013368606567
T_indexing = 160.24518656730652
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.7678203071281229
top-5 accuracy :  0.8943101077240431
maj accuracy class :  0.7854114141645656
f1 score :  0.7678203071281229
t_tot: 504.602557182312
t_model: 154.7530961036682
t_transfer: 1.986562967300415
t_search: 336.5730233192444
-----------------------------------------------------------------------------------------------
------------------------------------- Model 2 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/deit/model5/last_epoch
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 3.5130457878112793
Time of the transfer: 345.0420913696289
Time of the indexing: 7.552582263946533
T_indexing = 363.3633363246918
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.6860818244327298
top-5 accuracy :  0.8660325464130185
maj accuracy class :  0.7097180838872336
f1 score :  0.6860818244327298
t_tot: 602.7621517181396
t_model: 174.5907289981842
t_transfer: 66.54890727996826
t_search: 349.9755938053131
-----------------------------------------------------------------------------------------------
------------------------------------- Model 3 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model11/pretrained_vit_small_checkpoint.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model11/pretrained_vit_small_checkpoint.pth and loaded with msg: <All keys matched successfully>
Time of the model: 3.06388783454895
Time of the transfer: 123.71747493743896
Time of the indexing: 7.981964588165283
T_indexing = 141.63793659210205
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model11/pretrained_vit_small_checkpoint.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  0.7031572312628925
top-5 accuracy :  0.8544292917717167
maj accuracy class :  0.7206050882420353
f1 score :  0.7031572312628925
t_tot: 1210.8178446292877
t_model: 159.04432153701782
t_transfer: 1.7408041954040527
t_search: 1038.5745794773102
-----------------------------------------------------------------------------------------------
------------------------------------- Model 4 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model12/checkpoint0099_scratch.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model12/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
Time of the model: 3.16322922706604
Time of the transfer: 123.59411478042603
Time of the indexing: 7.937143087387085
T_indexing = 141.36074328422546
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model12/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
-----------------------------------------------------------------------------------------------
------------------------------------- Model 5 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model13/checkpoint0099_pretrained.pth
Indexing
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 6 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/byol_light/model15/epoch=67-step=112132.ckpt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 7 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/byol_light/model18/epoch=45-step=75854.ckpt
Indexing
-----------------------------------------------------------------------------------------------
------------------------------------- Model 4 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model12/checkpoint0099_scratch.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model12/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
Time of the model: 3.176154613494873
Time of the transfer: 123.29013109207153
Time of the indexing: 8.17479944229126
T_indexing = 141.52583289146423
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model12/checkpoint0099_scratch.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  0.7801684620673849
top-5 accuracy :  0.8925338070135228
maj accuracy class :  0.7980747192298877
f1 score :  0.7801684620673849
t_tot: 1200.345021724701
t_model: 155.04148173332214
t_transfer: 1.7946405410766602
t_search: 1032.0969660282135
-----------------------------------------------------------------------------------------------
------------------------------------- Model 5 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model13/checkpoint0099_pretrained.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model13/checkpoint0099_pretrained.pth and loaded with msg: <All keys matched successfully>
Time of the model: 2.9767143726348877
Time of the transfer: 123.9194884300232
Time of the indexing: 8.036674976348877
T_indexing = 142.14731645584106
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/Dino/model13/checkpoint0099_pretrained.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  0.769080907632363
top-5 accuracy :  0.8854286041714416
maj accuracy class :  0.7909981663992666
f1 score :  0.769080907632363
t_tot: 1232.837004184723
t_model: 166.50869989395142
t_transfer: 1.6651301383972168
t_search: 1053.1757943630219
-----------------------------------------------------------------------------------------------
------------------------------------- Model 6 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/byol_light/model15/epoch=67-step=112132.ckpt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 3.690878391265869
Time of the transfer: 142.39809823036194
Time of the indexing: 7.8524134159088135
T_indexing = 160.546936750412
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.8041198716479486
top-5 accuracy :  0.8892390556956222
maj accuracy class :  0.806669722667889
f1 score :  0.8041198716479486
t_tot: 840.1803772449493
t_model: 157.83721542358398
t_transfer: 2.666581630706787
t_search: 668.0838756561279
-----------------------------------------------------------------------------------------------
------------------------------------- Model 7 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/byol_light/model18/epoch=45-step=75854.ckpt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 3.770164728164673
Time of the transfer: 142.36934161186218
Time of the indexing: 7.837289094924927
T_indexing = 160.61947083473206
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.6461150584460233
top-5 accuracy :  0.793662617465047
maj accuracy class :  0.6075807930323173
f1 score :  0.6461150584460233
t_tot: 836.7937309741974
t_model: 156.6645905971527
t_transfer: 2.608206272125244
t_search: 666.0849335193634
-----------------------------------------------------------------------------------------------
------------------------------------- Model 8 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/byol_light/model19/epoch=99-step=500400.ckpt
Indexing
nvtopModel vit_small 16x16 built.
Model vit_base 16x16 built.
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 9 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/retccl/model24/ret_pretrained.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 3.3498215675354004
Time of the transfer: 142.42215776443481
Time of the indexing: 8.794401407241821
T_indexing = 162.10789823532104
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 8 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/byol_light/model19/epoch=99-step=500400.ckpt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 3.736793041229248
Time of the transfer: 142.41969537734985
Time of the indexing: 7.773737192153931
T_indexing = 160.5612027645111
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.6635915654366262
top-5 accuracy :  0.8864886545954619
maj accuracy class :  0.6949633279853312
f1 score :  0.6635915654366262
t_tot: 850.5521357059479
t_model: 162.86479449272156
t_transfer: 2.88150954246521
t_search: 673.181402683258
-----------------------------------------------------------------------------------------------
------------------------------------- Model 9 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/retccl/model24/ret_pretrained.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 3.421030282974243
Time of the transfer: 142.5295717716217
Time of the indexing: 9.111356258392334
T_indexing = 161.99531030654907
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.7903965161586065
top-5 accuracy :  0.8959145083658033
maj accuracy class :  0.7980460692184277
f1 score :  0.7903965161586065
t_tot: 5896.83392906189
t_model: 160.71853876113892
t_transfer: 2.0148797035217285
t_search: 5716.146133422852
-----------------------------------------------------------------------------------------------
------------------------------------- Model 10 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model27/checkpoint_teacher.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model27/checkpoint_teacher.pth and loaded with msg: <All keys matched successfully>
Time of the model: 3.0505447387695312
Time of the transfer: 123.50966191291809
Time of the indexing: 8.293155670166016
T_indexing = 141.65352725982666
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model27/checkpoint_teacher.pth and loaded with msg: <All keys matched successfully>
top-1 accuracy :  0.7028707311482925
top-5 accuracy :  0.8715619986247994
maj accuracy class :  0.7159637863855145
f1 score :  0.7028707311482925
t_tot: 1207.4832696914673
t_model: 159.77828097343445
t_transfer: 1.71213960647583
t_search: 1034.6337218284607
-----------------------------------------------------------------------------------------------
------------------------------------- Model 11 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model30/checkpoint_new.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 12 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model31/checkpoint24.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 13 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ctranspath/model29/ctranspath.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 5.3535425662994385
Time of the transfer: 185.09020733833313
Time of the indexing: 8.345135688781738
T_indexing = 205.30362105369568
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.8015986706394682
top-5 accuracy :  0.9201237680495072
maj accuracy class :  0.825005730002292
f1 score :  0.8015986706394682
t_tot: 2408.9355895519257
t_model: 273.11342191696167
t_transfer: 1.3584985733032227
t_search: 2122.2551000118256
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/uni/model32/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 15 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/cdpath/model33/CAMELYON17.ckpt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 2.8962385654449463
Time of the transfer: 8.400243759155273
Time of the indexing: 13.130215883255005
T_indexing = 32.00516986846924
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.7300309420123768
top-5 accuracy :  0.9159695163878065
maj accuracy class :  0.7596264038505616
f1 score :  0.7300309420123768
t_tot: 1489.8901209831238
t_model: 79.09194660186768
t_transfer: 1.5915677547454834
t_search: 1397.3357644081116
-----------------------------------------------------------------------------------------------
------------------------------------- Model 11 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model30/checkpoint_new.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) all
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) -----------------------------------------------------------------------------------------------
------------------------------------- Model 12 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model31/checkpoint24.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
-----------------------------------------------------------------------------------------------
------------------------------------- Model 11 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model30/checkpoint_new.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Take key teacher in provided checkpoint dict
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model30/checkpoint_new.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v', 'head.last_layer2.weight_g', 'head.last_layer2.weight_v'])
Time of the model: 3.152919054031372
Time of the transfer: 123.20444965362549
Time of the indexing: 8.026663303375244
T_indexing = 141.35017919540405
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Take key teacher in provided checkpoint dict
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model30/checkpoint_new.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v', 'head.last_layer2.weight_g', 'head.last_layer2.weight_v'])
top-1 accuracy :  0.8806154022461609
top-5 accuracy :  0.9490602796241119
maj accuracy class :  0.899782259912904
f1 score :  0.8806154022461609
t_tot: 1221.4641916751862
t_model: 161.76445817947388
t_transfer: 1.8522439002990723
t_search: 1046.004872083664
-----------------------------------------------------------------------------------------------
------------------------------------- Model 12 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model31/checkpoint24.pth
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Take key teacher in provided checkpoint dict
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model31/checkpoint24.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v', 'head.last_layer2.weight_g', 'head.last_layer2.weight_v'])
Time of the model: 2.9498789310455322
Time of the transfer: 123.38002395629883
Time of the indexing: 7.923485994338989
T_indexing = 141.44437098503113
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Take key teacher in provided checkpoint dict
Pretrained weights found at /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/ibot/model31/checkpoint24.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v', 'head.last_layer2.weight_g', 'head.last_layer2.weight_v'])
top-1 accuracy :  0.7745817098326839
top-5 accuracy :  0.9242493696997479
maj accuracy class :  0.8067270226908091
f1 score :  0.7745817098326839
t_tot: 1222.932651758194
t_model: 163.65540981292725
t_transfer: 1.699843168258667
t_search: 1046.1102194786072
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/uni/model32/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) all
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) Token is valid (permission: read).
Your token has been saved to /home/axelle/.cache/huggingface/token
Login successful
-----------------------------------------------------------------------------------------------
------------------------------------- Model 15 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/phikon/model26/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) Token is valid (permission: read).
Your token has been saved to /home/axelle/.cache/huggingface/token
Login successful
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/uni/model32/placeholder.txt
Indexing
all
-----------------------------------------------------------------------------------------------
------------------------------------- Model 15 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/phikon/model26/placeholder.txt
Indexing
all
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/uni/model32/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) all
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/uni/model32/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) Token is valid (permission: read).
Your token has been saved to /home/axelle/.cache/huggingface/token
Login successful
Time of the model: 5.077529191970825
Time of the transfer: 1178.3442044258118
Time of the indexing: 8.101958274841309
T_indexing = 1199.2039015293121
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) Token is valid (permission: read).
Your token has been saved to /home/axelle/.cache/huggingface/token
Login successful
top-1 accuracy :  0.9388895255558102
top-5 accuracy :  0.9789708915883566
maj accuracy class :  0.9549908319963328
f1 score :  0.9388895255558102
t_tot: 3503.362452983856
t_model: 300.31388688087463
t_transfer: 315.2785050868988
t_search: 2871.853584766388
-----------------------------------------------------------------------------------------------
------------------------------------- Model 15 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/phikon/model26/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Add token as git credential? (Y/n) Token is valid (permission: read).
Your token has been saved to /home/axelle/.cache/huggingface/token
Login successful
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.

    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    A token is already saved on your machine. Run `huggingface-cli whoami` to get more information or `huggingface-cli logout` if you want to log out.
    Setting a new token will erase the existing one.
    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
-----------------------------------------------------------------------------------------------
------------------------------------- Model 14 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/uni/model32/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 15 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/phikon/model26/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
-----------------------------------------------------------------------------------------------
------------------------------------- Model 15 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/phikon/model26/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
ViTModel(
  (embeddings): ViTEmbeddings(
    (patch_embeddings): ViTPatchEmbeddings(
      (projection): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
    )
    (dropout): Dropout(p=0.0, inplace=False)
  )
  (encoder): ViTEncoder(
    (layer): ModuleList(
      (0-11): 12 x ViTLayer(
        (attention): ViTSdpaAttention(
          (attention): ViTSdpaSelfAttention(
            (query): Linear(in_features=768, out_features=768, bias=True)
            (key): Linear(in_features=768, out_features=768, bias=True)
            (value): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (output): ViTSelfOutput(
            (dense): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (intermediate): ViTIntermediate(
          (dense): Linear(in_features=768, out_features=3072, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): ViTOutput(
          (dense): Linear(in_features=3072, out_features=768, bias=True)
          (dropout): Dropout(p=0.0, inplace=False)
        )
        (layernorm_before): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (layernorm_after): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      )
    )
  )
  (layernorm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
ViTModel(
  (embeddings): ViTEmbeddings(
    (patch_embeddings): ViTPatchEmbeddings(
      (projection): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
    )
    (dropout): Dropout(p=0.0, inplace=False)
  )
  (encoder): ViTEncoder(
    (layer): ModuleList(
      (0-11): 12 x ViTLayer(
        (attention): ViTSdpaAttention(
          (attention): ViTSdpaSelfAttention(
            (query): Linear(in_features=768, out_features=768, bias=True)
            (key): Linear(in_features=768, out_features=768, bias=True)
            (value): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (output): ViTSelfOutput(
            (dense): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (intermediate): ViTIntermediate(
          (dense): Linear(in_features=768, out_features=3072, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): ViTOutput(
          (dense): Linear(in_features=3072, out_features=768, bias=True)
          (dropout): Dropout(p=0.0, inplace=False)
        )
        (layernorm_before): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (layernorm_after): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      )
    )
  )
  (layernorm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
-----------------------------------------------------------------------------------------------
------------------------------------- Model 15 --------------------------------------------------
-----------------------------------------------------------------------------------------------
Weights: /home/axelle/Documents/Doctorat/WP1/WP1/weights_folder/phikon/model26/placeholder.txt
Indexing
Model vit_small 16x16 built.
Model vit_base 16x16 built.
Time of the model: 2.8147640228271484
Time of the transfer: 342.4823353290558
Time of the indexing: 7.9578537940979
T_indexing = 360.5272970199585
all
Model vit_small 16x16 built.
Model vit_base 16x16 built.
top-1 accuracy :  0.8091049736419894
top-5 accuracy :  0.918662617465047
maj accuracy class :  0.8382420352968141
f1 score :  0.8091049736419894
t_tot: 2381.620943546295
t_model: 164.9799976348877
t_transfer: 66.2633786201477
t_search: 2130.0632796287537
